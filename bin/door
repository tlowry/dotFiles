#!/bin/sh
[ -z "$2" ] && echo "use: door <remote_machine_name> " && exit 1

mk_key () {
    ssh-keygen -t rsa -q -f "$1" -N ""
    chmod 400 "$1"
    eval $(ssh-agent)
    ssh-add
}

key="$HOME/.ssh/id_rsa"
[ -f "$key" ] || mk_key "$key"  
cat "$key.pub" | ssh "$USER@$1" 'cat >> .ssh/authorized_keys'
