set shell sh

# exit on err + unset vars (safer shell exec)
set shellopts '-eu'

map <enter> shell

# execute current file (must be executable)
map x $$f
map X !$f

cmd open ${{
    case $(file --mime-type $f -b) in
        text/*) $EDITOR $fx;;
        *) for f in $fx; do setsid $OPENER $f > /dev/null 2> /dev/null & done;;
    esac
}}
